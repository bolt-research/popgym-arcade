<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Investigating Memory in RL with POPGym Arcade">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>
    Investigating Memory in RL with POPGym Arcade
  </title>

  <link rel="icon" href="./static/images/favicon.ico">

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
  <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
</nav>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-2 publication-title">
            Investigating Memory in RL with POPGym Arcade
          </h1>
            <div class="is-size-5 publication-authors">
              <span class="author-block"> 
                <a href="https://aphlios.github.io/">Zekang Wang</a><sup>1</sup>,
              </span>
              <span class="author-block"> 
                <a href="https://icyzhe.github.io/">Zhe He</a><sup>1</sup>,
              </span>
              <span class="author-block"> 
                <a href="https://github.com/EmporioZ">Borong Zhang</a><sup>1</sup>,
              </span>
              <span class="author-block"> 
                <a href="https://github.com/EdanToledo">Edan Toledo</a><sup>2</sup>,
              </span>
              <span class="author-block"> 
                <a href="https://www.dangersteve.com/">Steven Morad</a><sup>1</sup>
              </span>
              <br>
              <span class="author-block"><sup>1</sup>University of Macau,</span>
              <span class="author-block"><sup>2</sup>University College London</span>
              <br>
              
              <!-- <br> -->
              <div class="is-size-6 publication-authors">
                <!-- <span style="font-size: 0.9em;">*Equal Contribution</span><br> -->
                <!-- <span class="author-block">International Conference on Learning Representations (ICLR) 2025 <i><span class="achievement">[Oral]</span></i></span> -->
              </div>
            </div>
            <div class="column has-text-centered">
              <div class="publication-links">
                <span class="link-block">
                  <a href="https://arxiv.org/abs/2503.01450" target="_blank" 
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                        <i class="ai ai-arxiv"></i>
                    </span>
                    <span>arXiv</span>
                  </a>
                </span>
                <span class="link-block"> 
                  <a href="https://github.com/bolt-research/popgym-arcade" target="_blank" 
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                        <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span>
                <span class="link-block"> 
                  <a href="./bibtex.txt" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span>BibTeX</span>
                  </a>
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- <div class="container">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3">Video</h2>
          <div class="publication-video">
            <iframe src="https://www.youtube.com/embed/z6BsJYY-5UU?rel=0&amp;showinfo=0" frameborder="0"
                    allow="autoplay; encrypted-media" allowfullscreen></iframe>
          </div>
        </div>
      </div>
    </div> -->
</section>

<section class="hero teaser">
  <div class="container is-max-desktop">
    <div id="results-carousel" class="carousel results-carousel">
      <div class="item">
        <div class="columns is-mobile is-gapless" style="margin-bottom: 0;">
          <div class="column">
            <img src="./static/images/autoencode_f.gif" alt="Autoencode F">
          </div>
          <div class="column">
            <img src="./static/images/autoencode_p.gif" alt="Autoencode P">
          </div>
        </div>
      </div>
      <div class="item">
        <div class="columns is-mobile is-gapless" style="margin-bottom: 0;">
          <div class="column">
            <img src="./static/images/battleship_f.gif" alt="Battleship F">
          </div>
          <div class="column">
            <img src="./static/images/battleship_p.gif" alt="Battleship P">
          </div>
        </div>
      </div>
      <div class="item">
        <div class="columns is-mobile is-gapless" style="margin-bottom: 0;">
          <div class="column">
            <img src="./static/images/breakout_f.gif" alt="Breakout F">
          </div>
          <div class="column">
            <img src="./static/images/breakout_p.gif" alt="Breakout P">
          </div>
        </div>
      </div>
      <div class="item">
        <div class="columns is-mobile is-gapless" style="margin-bottom: 0;">
          <div class="column">
            <img src="./static/images/cartpole_f.gif" alt="Cartpole F">
          </div>
          <div class="column">
            <img src="./static/images/cartpole_p.gif" alt="Cartpole P">
          </div>
        </div>
      </div>
      <div class="item">
        <div class="columns is-mobile is-gapless" style="margin-bottom: 0;">
          <div class="column">
            <img src="./static/images/countrecall_f.gif" alt="Count Recall F">
          </div>
          <div class="column">
            <img src="./static/images/countrecall_p.gif" alt="Count Recall P">
          </div>
        </div>
      </div>
      <div class="item">
        <div class="columns is-mobile is-gapless" style="margin-bottom: 0;">
          <div class="column">
            <img src="./static/images/minesweeper_f.gif" alt="Minesweeper F">
          </div>
          <div class="column">
            <img src="./static/images/minesweeper_p.gif" alt="Minesweeper P">
          </div>
        </div>
      </div>
      <div class="item">
        <div class="columns is-mobile is-gapless" style="margin-bottom: 0;">
          <div class="column">
            <img src="./static/images/navigator_f.gif" alt="Navigator F">
          </div>
          <div class="column">
            <img src="./static/images/navigator_p.gif" alt="Navigator P">
          </div>
        </div>
      </div>
      <div class="item">
        <div class="columns is-mobile is-gapless" style="margin-bottom: 0;">
          <div class="column">
            <img src="./static/images/ncartpole_f.gif" alt="Noisy Cartpole F">
          </div>
          <div class="column">
            <img src="./static/images/ncartpole_p.gif" alt="Noisy Cartpole P">
          </div>
        </div>
      </div>
      <div class="item">
        <div class="columns is-mobile is-gapless" style="margin-bottom: 0;">
          <div class="column">
            <img src="./static/images/skittles_f.gif" alt="Skittles F">
          </div>
          <div class="column">
            <img src="./static/images/skittles_p.gif" alt="Skittles P">
          </div>
        </div>
      </div>
      <div class="item">
        <div class="columns is-mobile is-gapless" style="margin-bottom: 0;">
          <div class="column">
            <img src="./static/images/tetris_f.gif" alt="Tetris F">
          </div>
          <div class="column">
            <img src="./static/images/tetris_p.gif" alt="Tetris P">
          </div>
        </div>
      </div>
    </div>
    <p style="font-size: 18px; text-align: center">
      Observations from our environment twins. All environments share a unifying observation and
action space, enabling counterfactual studies with observability as the sole independent variable.
    </p>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column">

        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            How should we analyze memory in deep RL? We introduce mathematical tools for fairly analyzing policies under partial observability and revealing how agents use memory to make decisions. To utilize these tools, we present POPGym Arcade, a collection of Atari-inspired, hardware-accelerated, pixel-based environments sharing a single observation and action space. Each environment provides fully and partially observable variants, enabling counterfactual studies on observability. We find that controlled studies are necessary for fair comparisons, and identify a pathology where value functions smear credit over irrelevant history. With this pathology, we demonstrate how out-of-distribution scenarios can contaminate memory, perturbing the policy far into the future, with implications for sim-to-real transfer and offline RL.
          </p>
          <br>
          <br>
        </div>
<!-- <br><br><br> -->
        <div class="container is-max-desktop">
          <img src="./static/images/fps.png" alt="FPS Comparison" style="width: 100%;">
          <p style="font-size: 18px; text-align: center; margin-top: 10px;">
            <b>Throughput:</b> Expect ~10M frames per second on an RTX4090. Most of our policies converge in less than 60 minutes of training.
          </p>
        </div>
<br><br><br>
          <div class="container is-max-desktop">
          <img src="./static/images/quad.png" alt="FPS Comparison" style="width: 100%;">
          <p style="font-size: 18px; text-align: center; margin-top: 10px;">
            How do trained agents use memory? We plot pixelwise memory gradients for the LRU (top rows) and GRU (bottom rows), denoting how much each pixel contributes to future value estimate $V(s_t)$ through memory. In these MDPs, $V_*(s_{t})$ is independent of $s_{t-k} \dots s_{t-1}$, yet memory incorrectly smears value credit over uninformative past states, even with a residual connection bypassing the memory model. Smeared value attribution suggests value estimators may not generalize to new trajectories.
          </p>
        </div>

        <br><br><br>
          <div class="container is-max-desktop">
          <img src="./static/images/gap_bias_plot.png" alt="FPS Comparison" style="width: 100%;">
          <p style="font-size: 18px; text-align: center; margin-top: 10px;">
          We disentangle the return using our memory analysis tools. We plot the POMDP returns $\in [0, 1]$, the Observability Gap, and Memory Bias. We aggregate scores over all environments and difficulty configurations. Whiskers represent the 95% confidence interval over five seeds.          </p>
        </div>

<!-- End of content -->
      <br/>
    </div>
  </div>
</section>

<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <div class="columns is-centered"><p>
            This website template is borrowed from <a href="https://github.com/nerfies/nerfies.github.io">Nerfies</a>
          </p></div>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>